<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>
<body>
    <form id="form">
        <div class="dilemma">
            <input type="text" id="option1" placeholder="option1">
            <p>or</p>
            <input type="text" id="option2" placeholder="option2">
            <div class="buttons">
                <button class="button" id="submit" type="submit">submit dilemma</button>
                <button class="button" id="start">Start</button>
            </div>
        </div>        
    </form>

    <p class="waiting"> waiting for opponents<br><span>...</span></p>


    <script src="/socket.io/socket.io.js"></script>
    <script>
    {
        let socket;
        const dilemma = document.querySelector('.dilemma');


        const init = () => {
            socket = io();

            socket.on('connect', () => {
                console.log(`Connected: ${socket.id}`);

                //send the socket id to the server
                socket.emit('get-socket-id');

                //get the IP address of the server
                const ip = window.location.hostname;

                const url = `${window.location}/remote.html?targetSocketId=${socket.id}`;

                socket.emit('get-client-count');
                socket.on('client-count', (count) => {

                //add the values of the options in an array
                const options = [];
                const submit = document.getElementById('submit');
                const start = document.getElementById('start');
                const option1 = document.getElementById('option1');
                const option2 = document.getElementById('option2');
                const form = document.getElementById('form');
                const waiting = document.querySelector('.waiting');

                submit.addEventListener('click', (e) => {
                    e.preventDefault();
                    const option1Value = option1.value;
                    const option2Value = option2.value;

                    // Controleer of beide waarden ingevuld zijn
                    if (option1Value && option2Value) {
                        form.reset();

                        console.log(option1Value, option2Value);

                        // Verzend de waarden naar de server
                        socket.emit('submit-dilemma', { option1: option1Value, option2: option2Value });
                    } else {
                        return;
                }
                });

                start.addEventListener('click', (e) => {
                    e.preventDefault();
                    form.style.display = 'none';
                    waiting.style.display = 'block';

                    


                    //zend een bericht naar de server, die zegt dat de start knop is ingedrukt
                    socket.emit('start-dilemma');
                });


                socket.on('options-updated', (options) => {
                    console.log('Options:', options);  

                });


                socket.on('start-dilemma', () => {
                    console.log('Start button pressed, lets play!');
                    waiting.style.display = 'none';

                });
                    
            });
            
            
        
        });


        }; 

        init();
    }
    </script>
</body>
</html>
